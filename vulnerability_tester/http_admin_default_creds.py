from requests.auth import HTTPBasicAuth
import requests
import logging

def test_http_default_credentials(ip, port, args):
    if args.verbose:
        logging.basicConfig(level=logging.DEBUG, format='%(asctime)s - %(levelname)s - %(message)s')
    else:
        logging.basicConfig(level=logging.INFO, format='%(asctime)s - %(levelname)s - %(message)s')

    try:
        url = f"http://{ip}:{port}/"
        response = requests.get(url, auth=HTTPBasicAuth('admin', 'admin'), timeout=5)
        if response.status_code == 200 and "Welcome" in response.text:
            return True
        elif response.status_code == 401:
            return False
        else:
            logging.debug(f"Unexpected status {response.status_code} with body: {response.text}")
            return False
    except Exception as e:
        logging.error(f"Exception during HTTP auth test: {e}")
        return False
