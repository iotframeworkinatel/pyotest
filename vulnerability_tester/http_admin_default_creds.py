from requests.auth import HTTPBasicAuth
import requests

def test_http_default_credentials(ip, port):
    try:
        url = f"http://{ip}:{port}/"
        response = requests.get(url, auth=HTTPBasicAuth('admin', 'admin'), timeout=5)
        if response.status_code == 200 and "Welcome" in response.text:
            return True
        elif response.status_code == 401:
            return False
        else:
            print(f"[?] Unexpected status {response.status_code} with body: {response.text}")
            return False
    except Exception as e:
        print(f"[!] Exception during HTTP auth test: {e}")
        return False
