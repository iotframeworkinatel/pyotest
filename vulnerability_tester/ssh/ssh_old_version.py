import socket

def test_ssh_old_version(ip, port, timeout=3):
    try:
        s = socket.create_connection((ip, port), timeout=timeout)
        banner = s.recv(1024).decode(errors="ignore")
        s.close()

        return any(v in banner for v in ["SSH-1.", "OpenSSH_4", "OpenSSH_5", "OpenSSH_6"])
    except Exception:
        return False
