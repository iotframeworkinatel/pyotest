import requests

def test_http_dangerous_methods(ip, port, timeout=3):
    try:
        url = f"http://{ip}:{port}"
        r = requests.options(url, timeout=timeout)
        allow = r.headers.get("Allow", "")
        return any(m in allow for m in ["PUT", "DELETE"])
    except Exception:
        return False
