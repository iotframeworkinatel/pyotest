"""
Adaptive FTP test variants â€” ONLY executed by the AutoML/adaptive strategy.
These tests check real anonymous login and extended credentials not covered by
the static ftp_anonymous_login test (which only tries admin/admin).
"""
from ftplib import FTP


def test_ftp_anonymous_real(ip, port):
    """Try actual anonymous FTP login (user='anonymous', empty password)."""
    try:
        ftp = FTP()
        ftp.connect(ip, port, timeout=5)
        ftp.login(user="anonymous", passwd="")
        ftp.quit()
        return True
    except Exception:
        return False


def test_ftp_weak_credentials_extended(ip, port):
    """Try additional FTP credential pairs beyond admin/admin."""
    creds = [
        ("root", "root"),
        ("admin", "password"),
        ("admin", ""),
        ("ftp", "ftp"),
        ("user", "user"),
    ]
    for user, passwd in creds:
        try:
            ftp = FTP()
            ftp.connect(ip, port, timeout=5)
            ftp.login(user=user, passwd=passwd)
            ftp.quit()
            return True
        except Exception:
            pass
    return False
