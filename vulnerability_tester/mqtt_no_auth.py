import socket

def test_mqtt_open_access(ip, port):
    try:
        with socket.create_connection((ip, port), timeout=5) as s:
            # MQTT CONNECT packet (basic)
            s.sendall(b"\x10\x0E\x00\x04MQTT\x04\x02\x00\x3C\x00\x00")
            resp = s.recv(4)
            return resp.startswith(b"\x20")  # Connack frame
    except Exception as e:
        return False

