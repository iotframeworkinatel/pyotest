import pytest
import telnetlib
import socket

TIMEOUT = 5

@pytest.mark.vuln_id("TELNET_OPEN")
def test_TELNET_OPEN():
    ip = "{{ ip }}"
    port = 23

    try:
        tn = telnetlib.Telnet(ip, port, timeout=TIMEOUT)
        tn.close()
        assert True  # PASS → telnet aberto

    except (socket.timeout, ConnectionError, OSError):
        pytest.fail("Telnet não acessível")
